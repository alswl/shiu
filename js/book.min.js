(function(){var a={init:function(d){var b=this;b.db=window.shiu.db.Db;b.title=d.title;b.author=d.author;b.chapters=[];for(var e=0;e<d.chapters.length;e++){var c=Object.create(window.shiu.model.Chapter).init(d.chapters[e].title,d.chapters[e].content,e);b.chapters.push(c)}return b},setCurrentPage:function(c){var b=this;b.db.set(b.title+"_currentPage",c)},getCurrentPage:function(){var b=this;var c=b.db.get(b.title+"_currentPage");if(c===null||c>b.getPageCount()){c=0}return c},setPageCount:function(c){var b=this;b.db.set(b.title+"_pageCount",c)},getPageCount:function(){var b=this;return b.db.get(b.title+"_pageCount")},setCurrentChapterIndex:function(c){var b=this;this.db.set(b.title+"_currentChapterIndex",c)},getCurrentChapterIndex:function(){var b=this;index=b.db.get(b.title+"_currentChapterIndex");if(index===null||index>b.chapters.length){index=0}return index},getCurrentChapter:function(){var b=this;return b.chapters[b.getCurrentChapterIndex()]},getIndexsHtml:function(){var b=this;var d="";for(var c=0;c<b.chapters.length;c++){d+='<li><a href="javascript:;" rel="'+c+'">'+b.chapters[c].getCnIndex()+b.chapters[c].title+"</a></li>"}return d},};window.shiu.model.Book=a})();